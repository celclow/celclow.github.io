<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>ATOKローマ字設定ジェネレーター</title>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css"
        />
        <link
            rel="stylesheet"
            href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css"
        />

        <style>
            textarea {
                width: 100em;
                height: 10em;
            }
            .lab,
            .las {
                font-size: large;
            }
        </style>
        <script>
            function openModal(modalId) {
                const modal = document.getElementById(modalId);
                modal.addEventListener("click", (e) => {
                    const modalRect = modal.getBoundingClientRect();
                    if (
                        e.clientX < modalRect.left ||
                        e.clientX > modalRect.right ||
                        e.clientY < modalRect.top ||
                        e.clientY > modalRect.bottom
                    ) {
                        modal.close();
                    }
                });
                modal.showModal();
            }

            function loadSample() {
                document.getElementById("sokuon-keys").value =
                    "bcdfghjklmnprstvwxyz";
                document.getElementById("hatsuon-keys").value = "n";
                document.getElementById("romaji-table").value = `
,	、
-	ー
.	。
/	・
[	「
]	」
a	あ
ba	ば
be	べ
bi	び
bo	ぼ
bu	ぶ
bya	びゃ
bye	びぇ
byi	びぃ
byo	びょ
byu	びゅ
cha	ちゃ
che	ちぇ
chi	ち
cho	ちょ
chu	ちゅ
cya	ちゃ
cye	ちぇ
cyi	ちぃ
cyo	ちょ
cyu	ちゅ
da	だ
de	で
dha	でゃ
dhe	でぇ
dhi	でぃ
dho	でょ
dhu	でゅ
di	ぢ
do	ど
du	づ
dwu	どぅ
dya	ぢゃ
dye	ぢぇ
dyi	ぢぃ
dyo	ぢょ
dyu	ぢゅ
e	え
fa	ふぁ
fe	ふぇ
fi	ふぃ
fo	ふぉ
fu	ふ
fya	ふゃ
fye	ふぇ
fyi	ふぃ
fyo	ふょ
fyu	ふゅ
ga	が
ge	げ
gi	ぎ
go	ご
gu	ぐ
gwa	ぐぁ
gya	ぎゃ
gye	ぎぇ
gyi	ぎぃ
gyo	ぎょ
gyu	ぎゅ
ha	は
he	へ
hi	ひ
ho	ほ
hu	ふ
hya	ひゃ
hye	ひぇ
hyi	ひぃ
hyo	ひょ
hyu	ひゅ
i	い
ja	じゃ
je	じぇ
ji	じ
jo	じょ
ju	じゅ
jya	じゃ
jye	じぇ
jyi	じぃ
jyo	じょ
jyu	じゅ
ka	か
ke	け
ki	き
ko	こ
ku	く
kwa	くぁ
kya	きゃ
kye	きぇ
kyi	きぃ
kyo	きょ
kyu	きゅ
la	ぁ
le	ぇ
li	ぃ
lka	ヵ
lke	ヶ
lo	ぉ
ltsu	っ
ltu	っ
lu	ぅ
lwa	ゎ
lya	ゃ
lye	ぇ
lyi	ぃ
lyo	ょ
lyu	ゅ
ma	ま
me	め
mi	み
mo	も
mu	む
mya	みゃ
mye	みぇ
myi	みぃ
myo	みょ
myu	みゅ
n'	ん
na	な
ne	ね
ni	に
nn	ん
no	の
nu	ぬ
nya	にゃ
nye	にぇ
nyi	にぃ
nyo	にょ
nyu	にゅ
o	お
pa	ぱ
pe	ぺ
pi	ぴ
po	ぽ
pu	ぷ
pya	ぴゃ
pye	ぴぇ
pyi	ぴぃ
pyo	ぴょ
pyu	ぴゅ
ra	ら
re	れ
ri	り
ro	ろ
ru	る
rya	りゃ
rye	りぇ
ryi	りぃ
ryo	りょ
ryu	りゅ
sa	さ
se	せ
sha	しゃ
she	しぇ
shi	し
sho	しょ
shu	しゅ
si	し
so	そ
su	す
sya	しゃ
sye	しぇ
syi	しぃ
syo	しょ
syu	しゅ
ta	た
te	て
tha	てゃ
the	てぇ
thi	てぃ
tho	てょ
thu	てゅ
ti	ち
to	と
tsa	つぁ
tse	つぇ
tsi	つぃ
tso	つぉ
tsu	つ
tu	つ
twu	とぅ
tya	ちゃ
tye	ちぇ
tyi	ちぃ
tyo	ちょ
tyu	ちゅ
u	う
va	う゛ぁ
ve	う゛ぇ
vi	う゛ぃ
vo	う゛ぉ
vu	う゛
wa	わ
we	うぇ
wi	うぃ
wo	を
wu	う
wye	ゑ
wyi	ゐ
xa	ぁ
xe	ぇ
xi	ぃ
xka	ヵ
xke	ヶ
xo	ぉ
xtsu	っ
xtu	っ
xu	ぅ
xwa	ゎ
xya	ゃ
xye	ぇ
xyi	ぃ
xyo	ょ
xyu	ゅ
ya	や
ye	いぇ
yi	い
yo	よ
yu	ゆ
za	ざ
ze	ぜ
zi	じ
zo	ぞ
zu	ず
zya	じゃ
zye	じぇ
zyi	じぃ
zyo	じょ
zyu	じゅ
`.trim();
            }
        </script>
    <script defer src="main.js"></script></head>
    <body>
        <h1>ATOKローマ字設定ジェネレーター</h1>
        <p>
            必ずバックアップを取ってから利用してください。<br />
            自己責任でお願いします。
        </p>

        <h2>設定</h2>
        <p>
            <a href="javascript:loadSample();">サンプルをロード</a>
        </p>
        <form id="settings">
            <p>
                <label for="sokuon-keys"
                    >促音キー<a
                        href="javascript:openModal('sokuon-keys-modal');"
                        ><i class="las la-question-circle"></i></a
                ></label>
                <input type="text" id="sokuon-keys" />
                <dialog id="sokuon-keys-modal">
                    <h3>促音キー</h3>
                    <p>
                        子音を重ねて促音(っ)を入力する場合、子音をすべて設定してください。<br />
                        <a
                            href="http://hp.vector.co.jp/authors/VA002116/azik/azikinfo.htm"
                            >AZIK</a
                        >のようにセミコロン(;)のみで促音の入力を行い、子音を重ねて促音の入力することがない場合は設定不要です。
                    </p>
                    <p>
                        設定「ローマ字テーブル」では、Google日本語入力の「次の入力」のような方式には対応してないため、ここで設定する必要があります。
                    </p>
                </dialog>
            </p>
            <p>
                <label for="hatsuon-keys"
                    >撥音キー<a
                        href="javascript:openModal('hatuson-keys-modal');"
                        ><i class="las la-question-circle"></i></a
                ></label>
                <input type="text" id="hatsuon-keys" />
                <dialog id="hatuson-keys-modal">
                    <h3>撥音キー</h3>
                    <p>
                        「anko(あんこ)」の「n」のように後続の文字の存在によって撥音（ん）を入力する場合、設定してください。<br />
                        <a
                            href="http://hp.vector.co.jp/authors/VA002116/azik/azikinfo.htm"
                            >AZIK</a
                        >のように「Q」1字のみで撥音の入力を行い、後続の文字によって結果が変わらない場合は設定不要です。代わりに「ローマ字テーブル」で設定してください。
                    </p>
                </dialog>
            </p>
            <p>
                <label for="romaji-table"
                    >ローマ字テーブル<a
                        href="javascript:openModal('romaji-table-modal');"
                        ><i class="las la-question-circle"></i></a></label
                ><br />
                <!--
                    タブ文字の入力を可能にする
                    https://stackoverflow.com/questions/6637341/use-tab-to-indent-in-textarea#answer-32523641
                -->
                <textarea
                    id="romaji-table"
                    onkeydown="if(event.keyCode===9){var v=this.value,s=this.selectionStart,e=this.selectionEnd;this.value=v.substring(0, s)+'\t'+v.substring(e);this.selectionStart=this.selectionEnd=s+1;return false;}"
                ></textarea>
                <dialog id="romaji-table-modal">
                    <h3>ローマ字テーブル</h3>
                    <p>
                        ATOKの「ローマ字設定」で設定するような「ローマ字」「かな」をタブ区切りで設定してください。
                    </p>
                    <p>
                        「ローマ字」および「かな」はATOK上で登録可能な値を設定してください。
                    </p>
                    <p>タブ文字が含まれていない行は無視されます。</p>
                    <p>
                        Google日本語入力の「次の入力」が含まれる3列形式のTSVには対応していません。設定「促音キー」「撥音キー」を利用して設定してください。
                    </p>
                </dialog>
            </p>
            <p>
                <label
                    >出力フォーマット<a
                        href="javascript:openModal('output-format-modal');"
                        ><i class="las la-question-circle"></i></a></label
                ><br />
                <input
                    type="radio"
                    id="macos"
                    name="output-format"
                    value="macos"
                />
                <label for="macos">macOS</label>
                <input
                    type="radio"
                    id="windows"
                    name="output-format"
                    checked="checked"
                    value="windows"
                />
                <label for="windows">Windows</label>
                <dialog id="output-format-modal">
                    <h3>出力フォーマット</h3>
                    <p>
                        macOS版、Windows版で保存形式が異なります。利用するOSにあわせて選択してください。
                    </p>
                    <p>
                        Windowsを選択する場合、「促音キーの文字数」＋「撥音キーの文字数」＋「ローマ字テーブルの行数」を600以下にする必要があります。<br />
                        ※UI上でエラーは出力していませんが、該当のデータをインポートした場合、ATOKの挙動がおかしくなります。
                    </p>
                </dialog>
            </p>
            <p>
                <input type="submit" id="generate" value="Generate" />
            </p>
        </form>
        <h2>
            リザルト<a href="javascript:openModal('result-modal');"
                ><i class="las la-question-circle"></i
            ></a>
        </h2>
        <p>
            <dialog id="result-modal">
                <h3>リザルト</h3>
                <p>
                    macOSの場合、以下のファイルのローマ字データを変更します。<br />
                    ~/Library/Preferences/ATOK{version}/Styles/StUser{id}.plist
                </p>
                <p>
                    Windowsの場合、STYファイルをエクスポート後、ローマ字データを書き換え、インポートします。
                </p>
            </dialog>
            <textarea id="result" readonly="readonly"></textarea>
            <button
                onclick="navigator.clipboard.writeText(document.getElementById('result').value)"
            >
                Copy
            </button>
        </p>
        <h2>参考</h2>
        <ul>
            <li>
                <a href="https://hossy.info/?date=1105"
                    >ATOK2008 .styファイル覚え書き - hossy online -
                    といぼっくす</a
                >
            </li>
        </ul>
        <hr />
        <a href="https://github.com/celclow/atok-romaji-setting-generator"
            ><i class="lab la-github"></i>GitHub</a
        >
    </body>
</html>
